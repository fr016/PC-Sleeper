# Paramètres
$Account = "Dom1\CompteTestDom1"  # Compte utilisateur cible
$ComputerName = "SRVPARADSPa3"    # Nom de l'ordinateur distant

# Importer le module TaskScheduler
Import-Module TaskScheduler

# Récupérer les tâches planifiées sur l'ordinateur distant
$tasks = Get-ScheduledTask -CimSession $ComputerName

# Parcourir toutes les tâches planifiées
foreach ($task in $tasks) {
    # Vérifier si le compte utilisateur cible est associé à la tâche
    if ($task.Principal.UserId -eq $Account) {
        # Réinitialiser le mot de passe de la tâche
        $task | Set-ScheduledTask -UserCredential (Get-Credential) -RunLevel Highest
    }
}



ou ca :


# Paramètres
$Account = "Dom1\CompteTestDom1"  # Compte utilisateur cible
$ComputerName = "SRVPARADSPa3"    # Nom de l'ordinateur distant
$ReportPath = "C:\ResetPasswordReport.txt"  # Chemin du rapport de réinitialisation

# Importer le module TaskScheduler
Import-Module TaskScheduler

# Récupérer les tâches planifiées sur l'ordinateur distant
$tasks = Get-ScheduledTask -CimSession $ComputerName

# Créer un tableau pour stocker les tâches réinitialisées
$resetTasks = @()

# Parcourir toutes les tâches planifiées
foreach ($task in $tasks) {
    # Vérifier si le compte utilisateur cible est associé à la tâche
    if ($task.Principal.UserId -eq $Account) {
        # Réinitialiser le mot de passe de la tâche
        $task | Set-ScheduledTask -UserCredential (Get-Credential) -RunLevel Highest
        $resetTasks += $task
    }
}

# Générer le rapport de réinitialisation
if ($resetTasks.Count -gt 0) {
    $reportContent = "Les mots de passe des tâches suivantes ont été réinitialisés:`r`n`r`n"
    foreach ($resetTask in $resetTasks) {
        $reportContent += "Tâche : $($resetTask.TaskName)`r`n"
        $reportContent += "Description : $($resetTask.Description)`r`n"
        $reportContent += "`r`n"
    }
    $reportContent | Out-File -FilePath $ReportPath -Encoding UTF8
    Write-Host "Le rapport de réinitialisation a été généré : $ReportPath"
}
else {
    Write-Host "Aucune tâche n'a été trouvée pour réinitialiser le mot de passe."
}
