<#
.SYNOPSIS
    Measures Active Directory replication latency between domain controllers using whenChanged.

.DESCRIPTION
    This script creates a temporary user account on the PDC Emulator of a specified domain 
    and checks how long it takes for the account to replicate to all domain controllers.
    It compares the whenChanged timestamp on each DC to the creation time on the PDC.

.PARAMETER DomainFQDN
    The FQDN of the domain to target. Default is 'caza'.

.PARAMETER ReplicationLatencyThreshold
    Optional. Latency threshold (in seconds) to highlight delays in red. Default: 500.

.PARAMETER SimulationMode
    Optional. If specified, the script simulates data without any real interaction with AD.

.NOTES
    Author: Indentation Man
    Version: 1.7
#>

# ... (script content is the same as previously generated) ...

Test-ADReplicationLatency -SimulationMode
